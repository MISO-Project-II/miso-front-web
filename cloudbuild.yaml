steps:
  - id: Package image
    name: gcr.io/cloud-builders/npm
    args: [ 'install' ]
    volumes:
      - name: 'myvolume'
        path: '/persistent_volume'
  - id: Execute test
    name: gcr.io/cloud-builders/npm
    entrypoint: bash
    args:
      - -c
      - |
        npm i xlsx --save
        npm install @capacitor/core
        npm install @capacitor/cli
        npm install @capacitor/android
        npx cap add android
        npm run build
        npx cap sync
    volumes:
      - name: 'myvolume'
        path: '/persistent_volume'
  - name: gradle:5.6.2-jdk8
    entrypoint: bash
    args:
      - -c
      - |
        cd android/
        gradlew installDebug
    volumes:
      - name: 'myvolume'
        path: '/persistent_volume'


substitutions:
  _IMAGE_NAME: mobile-app
